{"version":3,"file":"buildDuration.js","sourceRoot":"","sources":["../../src/metrics/buildDuration.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAA,8DAAoD;AACpD,6DAAmE;AACnE,uDAAmC;AAEnC,MAAM,iCAAiC,GAAG,qBAAqB,CAAC;AAChE,MAAM,gCAAgC,GAAG,oBAAoB,CAAC;AAE9D,SAAgB,QAAQ;IACtB,KAAK,MAAM,UAAU,IAAI,CAAC,iCAAiC,EAAE,gCAAgC,CAAC,EAAE;QAC9F,gBAAM,CAAC,IAAI,CAAC,qCAAqC,UAAU,EAAE,CAAC,CAAC;QAC/D,UAAU,CAAC,cAAc,CAAC;YACxB,UAAU;YACV,IAAI,EAAE,SAAS;YACf,UAAU,EAAE,IAAI;SACjB,CAAC,CAAC;KACJ;AACH,CAAC;AATD,4BASC;AAED,SAAgB,iBAAiB,CAAC,IAAY,EAAE,KAAa,EAAE,OAAO,GAAG,IAAI;IAC3E,UAAU,CAAC,aAAa,CAAC;QACvB,IAAI,EAAE,iCAAiC;QACvC,KAAK;QACL,OAAO;QACP,eAAe,EAAE,4BAAe,CAAC,IAAI,CAAC;KACvC,CAAC,CAAC;AACL,CAAC;AAPD,8CAOC;AAED,SAAgB,gBAAgB,CAAC,IAAY,EAAE,KAAa,EAAE,OAAO,GAAG,IAAI;IAC1E,UAAU,CAAC,aAAa,CAAC;QACvB,IAAI,EAAE,gCAAgC;QACtC,KAAK;QACL,OAAO;QACP,eAAe,EAAE,4BAAe,CAAC,IAAI,CAAC;KACvC,CAAC,CAAC;AACL,CAAC;AAPD,4CAOC","sourcesContent":["import * as cloudwatch from 'turtle/aws/cloudwatch';\nimport { TYPE_DIMENSIONS } from 'turtle/aws/cloudwatch/dimensions';\nimport logger from 'turtle/logger';\n\nconst TURTLE_BUILD_DURATION_METRIC_NAME = 'turtleBuildDuration';\nconst TOTAL_BUILD_DURATION_METRIC_NAME = 'totalBuildDuration';\n\nexport function register() {\n  for (const metricName of [TURTLE_BUILD_DURATION_METRIC_NAME, TOTAL_BUILD_DURATION_METRIC_NAME]) {\n    logger.info(`Registered AWS Cloudwatch metric: ${metricName}`);\n    cloudwatch.registerMetric({\n      metricName,\n      unit: 'Seconds',\n      statistics: true,\n    });\n  }\n}\n\nexport function addTurtleDuration(type: string, value: number, success = true) {\n  cloudwatch.addMetricData({\n    name: TURTLE_BUILD_DURATION_METRIC_NAME,\n    value,\n    success,\n    extraDimensions: TYPE_DIMENSIONS(type),\n  });\n}\n\nexport function addTotalDuration(type: string, value: number, success = true) {\n  cloudwatch.addMetricData({\n    name: TOTAL_BUILD_DURATION_METRIC_NAME,\n    value,\n    success,\n    extraDimensions: TYPE_DIMENSIONS(type),\n  });\n}\n"]}